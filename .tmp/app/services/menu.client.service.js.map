{"version":3,"sources":["app/services/menu.client.service.js"],"names":[],"mappings":"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","file":"app/services/menu.client.service.js","sourcesContent":["(function () {\n  'use strict';\n\n\n\n  function menuService() {\n\n    var shouldRender;\n    var service = {\n      addMenu:  function addMenu(menuId, options) {\n        options = options || {};\n\n        // Create the new menu\n        service.menus[menuId] = {\n          roles: options.roles || service.defaultRoles,\n          items: options.items || [],\n          shouldRender: shouldRender\n        };\n\n        // Return the menu object\n        return service.menus[menuId];\n      },\n      addMenuItem: function addMenuItem(menuId, options) {\n        options = options || {};\n\n        // Validate that the menu exists\n        service.validateMenuExistance(menuId);\n\n        // Push new menu item\n        service.menus[menuId].items.push({\n          title: options.title || '',\n          state: options.state || '',\n          type: options.type || 'item',\n          class: options.class,\n          roles: ((options.roles === null || typeof options.roles === 'undefined') ? service.defaultRoles : options.roles),\n          position: options.position || 0,\n          items: [],\n          shouldRender: shouldRender\n        });\n\n        // Add submenu items\n        if (options.items) {\n          for (var i in options.items) {\n            if (options.items.hasOwnProperty(i)) {\n              service.addSubMenuItem(menuId, options.state, options.items[i]);\n            }\n          }\n        }\n\n        // Return the menu object\n        return service.menus[menuId];\n      },\n      addSubMenuItem: function addSubMenuItem(menuId, parentItemState, options) {\n        options = options || {};\n\n        // Validate that the menu exists\n        service.validateMenuExistance(menuId);\n\n        // Search for menu item\n        for (var itemIndex in service.menus[menuId].items) {\n          if (service.menus[menuId].items[itemIndex].state === parentItemState) {\n            // Push new submenu item\n            service.menus[menuId].items[itemIndex].items.push({\n              title: options.title || '',\n              state: options.state || '',\n              roles: ((options.roles === null || typeof options.roles === 'undefined') ? service.menus[menuId].items[itemIndex].roles : options.roles),\n              position: options.position || 0,\n              shouldRender: shouldRender\n            });\n          }\n        }\n\n        // Return the menu object\n        return service.menus[menuId];\n      },\n      defaultRoles: ['user', 'admin'],\n      getMenu:  function getMenu(menuId) {\n        // Validate that the menu exists\n\n\n        service.validateMenuExistance(menuId);\n\n        // Return the menu object\n        return service.menus[menuId];\n\n      },\n      menus: {},\n      removeMenu:  function removeMenu(menuId) {\n        // Validate that the menu exists\n        service.validateMenuExistance(menuId);\n\n        delete service.menus[menuId];\n      },\n      removeMenuItem: function removeMenuItem(menuId, menuItemState) {\n        // Validate that the menu exists\n        service.validateMenuExistance(menuId);\n\n        // Search for menu item to remove\n        for (var itemIndex in service.menus[menuId].items) {\n          if (service.menus[menuId].items.hasOwnProperty(itemIndex) && service.menus[menuId].items[itemIndex].state === menuItemState) {\n            service.menus[menuId].items.splice(itemIndex, 1);\n          }\n        }\n\n        // Return the menu object\n        return service.menus[menuId];\n      },\n      removeSubMenuItem:   function removeSubMenuItem(menuId, submenuItemState) {\n        // Validate that the menu exists\n        service.validateMenuExistance(menuId);\n\n        // Search for menu item to remove\n        for (var itemIndex in service.menus[menuId].items) {\n          if (this.menus[menuId].items.hasOwnProperty(itemIndex)) {\n            for (var subitemIndex in service.menus[menuId].items[itemIndex].items) {\n              if (this.menus[menuId].items[itemIndex].items.hasOwnProperty(subitemIndex) && service.menus[menuId].items[itemIndex].items[subitemIndex].state === submenuItemState) {\n                service.menus[menuId].items[itemIndex].items.splice(subitemIndex, 1);\n              }\n            }\n          }\n        }\n\n        // Return the menu object\n        return service.menus[menuId];\n      },\n      validateMenuExistance: function validateMenuExistance(menuId) {\n        if (menuId && menuId.length) {\n          if (service.menus[menuId]) {\n            return true;\n          } else {\n            throw new Error('Menu does not exist');\n          }\n        } else {\n          throw new Error('MenuId was not provided');\n        }\n      }\n    };\n\n    function init() {\n      // A private function for rendering decision\n      shouldRender = function (user) {\n        if (this.roles.indexOf('*') !== -1) {\n          return true;\n        } else {\n          if (!user) {\n            return false;\n          }\n\n          for (var userRoleIndex in user.roles) {\n            if (user.roles.hasOwnProperty(userRoleIndex)) {\n              for (var roleIndex in this.roles) {\n                if (this.roles.hasOwnProperty(roleIndex) && this.roles[roleIndex] === user.roles[userRoleIndex]) {\n                  return true;\n                }\n              }\n            }\n          }\n        }\n\n        return false;\n      };\n\n      // Adding the topbar menu\n      service.addMenu('topbar', {\n        roles: ['*']\n      });\n    }\n\n    init();\n\n    return service;\n\n\n  }\n\n  angular\n    .module('Menus',[])\n    .factory('menuService', menuService);\n}());\n"],"sourceRoot":"/source/"}